#!! -------------------------
#!! GENERAL CONFIGURATION
#!! -------------------------

[Analysis]
tag = 8TeV

#!! If this Flag is used then 50% of MC samples will go in training and the rest will be scaled up by a factor of 2.
#!! if you train on 50% but then set it to 'Fakse' while writing DC, then you get your biased training samples in the limit!!!
#!! be sure to have this right !!!
TrainFlag = True
#Mjj-> False

#!! -------------------------
#!! REGRESSION
#!! -------------------------

[Regression]
#regWeight = weights/MVA_BDT_REG_Oct8_13TeV.weights.xml
regWeight = ../python/weights/MVA_BDT_REG_Oct8_13TeV.weights.xml
regVars = ['Jet_pt[hJCidx]', 'VHbb::evalJERBias(Jet_rawPt[hJCidx],Jet_mcPt[hJCidx],Jet_eta[hJCidx])', 'Jet_mass[hJCidx]', 'VHbb::evalEtFromPtEtaPhiM(Jet_pt[hJCidx],Jet_eta[hJCidx],Jet_phi[hJCidx],Jet_mass[hJCidx])', 'VHbb::evalMtFromPtEtaPhiM(Jet_pt[hJCidx],Jet_eta[hJCidx],Jet_phi[hJCidx],Jet_mass[hJCidx])', 'Jet_leadTrackPt[hJCidx]', 'max(0,(Jet_leptonPtRel[hJCidx]))', 'max(0,(Jet_leptonDeltaR[hJCidx]))', 'max(0,(Jet_leptonPt[hJCidx]))', 'Jet_chEmEF[hJCidx]', 'Jet_mult[hJCidx]', 'max(0,Jet_vtxPt[hJCidx])', 'max(0,Jet_vtxMass[hJCidx])', 'max(0,Jet_vtx3DVal[hJCidx])', 'max(0,Jet_vtx3DSig[hJCidx])', 'met_pt', 'VHbb::deltaPhi(met_phi,Jet_phi[hJCidx])']
regDict = {'max(0,(Jet_leptonPt[hJCidx]))': 'max(0,(Jet_leptonPt[hJCidx[0]]))', 'max(0,Jet_vtxPt[hJCidx])': 'max(0,Jet_vtxPt[hJCidx[0]])', 'Jet_mass[hJCidx]': 'Jet_mass[hJCidx[0]]', 'max(0,(Jet_leptonPtRel[hJCidx]))': 'max(0,(Jet_leptonPtRel[hJCidx[0]]))', 'max(0,(Jet_leptonDeltaR[hJCidx]))': 'max(0,(Jet_leptonDeltaR[hJCidx[0]]))', 'VHbb::evalEtFromPtEtaPhiM(Jet_pt[hJCidx],Jet_eta[hJCidx],Jet_phi[hJCidx],Jet_mass[hJCidx])': 'VHbb::evalEt(Jet_pt[hJCidx[0]],Jet_eta[hJCidx[0]],Jet_phi[hJCidx[0]],VHbb::GetEnergy(Jet_pt[hJCidx[0]],Jet_eta[hJCidx[0]],Jet_mass[hJCidx[0]]))', 'Jet_leadTrackPt[hJCidx]': 'Jet_leadTrackPt[hJCidx[0]]', 'Jet_chEmEF[hJCidx]': 'Jet_chEmEF[hJCidx[0]]', 'met_pt': 'met_pt', 'VHbb::evalMtFromPtEtaPhiM(Jet_pt[hJCidx],Jet_eta[hJCidx],Jet_phi[hJCidx],Jet_mass[hJCidx])': 'VHbb::evalMt(Jet_pt[hJCidx[0]],Jet_eta[hJCidx[0]],Jet_phi[hJCidx[0]],VHbb::GetEnergy(Jet_pt[hJCidx[0]],Jet_eta[hJCidx[0]],Jet_mass[hJCidx[0]]))', 'VHbb::deltaPhi(met_phi,Jet_phi[hJCidx])': 'VHbb::deltaPhi(met_phi,Jet_phi[hJCidx[0]])', 'max(0,Jet_vtx3DSig[hJCidx])': 'max(0,Jet_vtx3DSig[hJCidx[0]])', 'Jet_mult[hJCidx]': 'Jet_mult[hJCidx[0]]', 'max(0,Jet_vtxMass[hJCidx])': 'max(0,Jet_vtxMass[hJCidx[0]])', 'Jet_pt[hJCidx]': 'Jet_pt[hJCidx[0]]', 'VHbb::evalJERBias(Jet_rawPt[hJCidx],Jet_mcPt[hJCidx],Jet_eta[hJCidx])': 'VHbb::evalJERBias(Jet_rawPt[hJCidx[0]],Jet_mcPt[hJCidx[0]],Jet_eta[hJCidx[0]])', 'max(0,Jet_vtx3DVal[hJCidx])': 'max(0,Jet_vtx3DVal[hJCidx[0]])'}
#regVars = ['Jet_pt[hJCidx]', 'VHbb::evalJERBias(Jet_rawPt[hJCidx],Jet_mcPt[hJCidx],Jet_eta[hJCidx])', 'Jet_mass[hJCidx]', 'VHbb::evalEtFromPtEtaPhiM(Jet_pt[hJCidx],Jet_eta[hJCidx],Jet_phi[hJCidx],Jet_mass[hJCidx])', 'VHbb::evalMtFromPtEtaPhiM(Jet_pt[hJCidx],Jet_eta[hJCidx],Jet_phi[hJCidx],Jet_mass[hJCidx])', 'Jet_leadTrackPt[hJCidx]', 'max(0,(Jet_leptonPtRel[hJCidx]*(1==1||1==1)))', 'max(0,(Jet_leptonDeltaR[hJCidx]*(1==1||1==1)))', 'max(0,(Jet_leptonPt[hJCidx]*(1==1||1==1)))', 'Jet_chEmEF[hJCidx]', 'Jet_mult[hJCidx]', 'max(0,Jet_vtxPt[hJCidx])', 'max(0,Jet_vtxMass[hJCidx])', 'max(0,Jet_vtx3DVal[hJCidx])', 'max(0,Jet_vtx3DSig[hJCidx])', 'met_pt', 'VHbb::deltaPhi(met_phi,Jet_phi[hJCidx])']
#regDict = {'max(0,(Jet_leptonPt[hJCidx]*(1==1||1==1)))': 'max(0,(Jet_leptonPt[hJCidx[0]]*(1[0]==1||1[0]==1)))', 'max(0,Jet_vtxPt[hJCidx])': 'max(0,Jet_vtxPt[hJCidx[0]])', 'Jet_mass[hJCidx]': 'Jet_mass[hJCidx[0]]', 'max(0,(Jet_leptonPtRel[hJCidx]*(1==1||1==1)))': 'max(0,(Jet_leptonPtRel[hJCidx[0]]*(1[0]==1||1[0]==1)))', 'max(0,(Jet_leptonDeltaR[hJCidx]*(1==1||1==1)))': 'max(0,(Jet_leptonDeltaR[hJCidx[0]]*(1[0]==1||1[0]==1)))', 'VHbb::evalEtFromPtEtaPhiM(Jet_pt[hJCidx],Jet_eta[hJCidx],Jet_phi[hJCidx],Jet_mass[hJCidx])': 'VHbb::evalEt(Jet_pt[hJCidx[0]],Jet_eta[hJCidx[0]],Jet_phi[hJCidx[0]],VHbb::GetEnergy(Jet_pt[hJCidx[0]],Jet_eta[hJCidx[0]],Jet_mass[hJCidx[0]]))', 'Jet_leadTrackPt[hJCidx]': 'Jet_leadTrackPt[hJCidx[0]]', 'Jet_chEmEF[hJCidx]': 'Jet_chEmEF[hJCidx[0]]', 'met_pt': 'met_pt', 'VHbb::evalMtFromPtEtaPhiM(Jet_pt[hJCidx],Jet_eta[hJCidx],Jet_phi[hJCidx],Jet_mass[hJCidx])': 'VHbb::evalMt(Jet_pt[hJCidx[0]],Jet_eta[hJCidx[0]],Jet_phi[hJCidx[0]],VHbb::GetEnergy(Jet_pt[hJCidx[0]],Jet_eta[hJCidx[0]],Jet_mass[hJCidx[0]]))', 'VHbb::deltaPhi(met_phi,Jet_phi[hJCidx])': 'VHbb::deltaPhi(met_phi,Jet_phi[hJCidx[0]])', 'max(0,Jet_vtx3DSig[hJCidx])': 'max(0,Jet_vtx3DSig[hJCidx[0]])', 'Jet_mult[hJCidx]': 'Jet_mult[hJCidx[0]]', 'max(0,Jet_vtxMass[hJCidx])': 'max(0,Jet_vtxMass[hJCidx[0]])', 'Jet_pt[hJCidx]': 'Jet_pt[hJCidx[0]]', 'VHbb::evalJERBias(Jet_rawPt[hJCidx],Jet_mcPt[hJCidx],Jet_eta[hJCidx])': 'VHbb::evalJERBias(Jet_rawPt[hJCidx[0]],Jet_mcPt[hJCidx[0]],Jet_eta[hJCidx[0]])', 'max(0,Jet_vtx3DVal[hJCidx])': 'max(0,Jet_vtx3DVal[hJCidx[0]])'}
#regWeightFilterJets = ../data/MVA_BDT_REG_FilterJet.weights.xml
regWeightFilterJets = ../python/weights/MVA_BDT_REG_Oct8_13TeV.weights.xml
regDictFilterJets = {"fathFilterJets_pt":"fathFilterJets_pt[0]","VHbb::evalJERBias(fathFilterJets_ptRaw,fathFilterJets_genPt,fathFilterJets_eta)":"VHbb::evalJERBias(fathFilterJets_ptRaw[0],fathFilterJets_genPt[0],fathFilterJets_eta[0])","rho25":"rho25","VHbb::evalEt(fathFilterJets_pt,fathFilterJets_eta,fathFilterJets_phi,fathFilterJets_e)":"VHbb::evalEt(fathFilterJets_pt[0],fathFilterJets_eta[0],fathFilterJets_phi[0],fathFilterJets_e[0])","VHbb::evalMt(fathFilterJets_pt,fathFilterJets_eta,fathFilterJets_phi,fathFilterJets_e)":"VHbb::evalMt(fathFilterJets_pt[0],fathFilterJets_eta[0],fathFilterJets_phi[0],fathFilterJets_e[0])","fathFilterJets_ptLeadTrack":"fathFilterJets_ptLeadTrack[0]","max(0,fathFilterJets_vtxPt)":"max(0,fathFilterJets_vtxPt[0])","max(0,fathFilterJets_vtxMass)":"max(0,fathFilterJets_vtxMass[0])","max(0,fathFilterJets_vtx3dL)":"max(0,fathFilterJets_vtx3dL[0])","max(0,fathFilterJets_vtx3deL)":"max(0,fathFilterJets_vtx3deL[0])","met_pt":"METet","VHbb::deltaPhi(met_phi,fathFilterJets_phi)":"VHbb::deltaPhi(met_phi,fathFilterJets_phi[0])"}
regVarsFilterJets = ["fathFilterJets_pt","VHbb::evalJERBias(fathFilterJets_ptRaw,fathFilterJets_genPt,fathFilterJets_eta)","rho25","VHbb::evalEt(fathFilterJets_pt,fathFilterJets_eta,fathFilterJets_phi,fathFilterJets_e)","VHbb::evalMt(fathFilterJets_pt,fathFilterJets_eta,fathFilterJets_phi,fathFilterJets_e)","fathFilterJets_ptLeadTrack","max(0,fathFilterJets_vtxPt)","max(0,fathFilterJets_vtxMass)","max(0,fathFilterJets_vtx3dL)","max(0,fathFilterJets_vtx3deL)","met_pt","VHbb::deltaPhi(met_phi,fathFilterJets_phi)"]

#!! --------------------------
#!! Libraries
#!! --------------------------
[BTagReshaping]
library=<!Directories|vhbbpath!>/interface/BTagReshaping_h.so
[VHbbNameSpace]
library=<!Directories|vhbbpath!>/interface/VHbbNameSpace_h.so

#!! for the likelihood
[AngularLike]
backgrounds = ['Zbb','Zudsg','ttbar','ZZ']
yields = {'Zbb':584.8,'Zudsg':881.61,'ttbar':135.7,'ZZ':44.04,'Sig':5.13}

#!! --------------------------
#!! SYSTEMATICS
#!! --------------------------
[systematics]
systematics: Nominal JER_up JER_down JES_up JES_down beff_up beff_down bmis_up bmis_down beff1_up beff1_down

#!! --------------------------------------------------
#!! Variables definition for trainging and evaluation
#!! --------------------------------------------------
[treeVarsICHEPnoDeltaPull]
Nominal: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]]
JER_up: H_JER.mass_up H_JER.pt_up HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JER_up[0] Jet_pt[hJCidx]_JER_up[1]
JER_down: H_JER.mass_down H_JER.pt_down HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JER_down[0] Jet_pt[hJCidx]_JER_down[1]
JES_up: H_JES.mass_up H_JES.pt_up HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JES_up[0] Jet_pt[hJCidx]_JES_up[1]
JES_down: H_JES.mass_down H_JES.pt_down HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JES_down[0] Jet_pt[hJCidx]_JES_down[1]
beff_up: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]Up[0],Jet_btagnew[hJCidx]Up[1]) min(Jet_btagnew[hJCidx]Up[0],Jet_btagnew[hJCidx]Up[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]]
beff_down: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]Down[0],Jet_btagnew[hJCidx]Down[1]) min(Jet_btagnew[hJCidx]Down[0],Jet_btagnew[hJCidx]Down[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]]
bmis_up: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]FUp[0],Jet_btagnew[hJCidx]FUp[1]) min(Jet_btagnew[hJCidx]FUp[0],Jet_btagnew[hJCidx]FUp[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]]
bmis_down: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]FDown[0],Jet_btagnew[hJCidx]FDown[1]) min(Jet_btagnew[hJCidx]FDown[0],Jet_btagnew[hJCidx]FDown[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]]
beff1_up: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]]
beff1_down: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]]


[treeVarsICHEP]
Nominal: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1
JER_up: H_JER.mass_up H_JER.pt_up HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JER_up[0] Jet_pt[hJCidx]_JER_up[1] 1 1
JER_down: H_JER.mass_down H_JER.pt_down HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JER_down[0] Jet_pt[hJCidx]_JER_down[1] 1 1
JES_up: H_JES.mass_up H_JES.pt_up HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JES_up[0] Jet_pt[hJCidx]_JES_up[1] 1 1
JES_down: H_JES.mass_down H_JES.pt_down HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JES_down[0] Jet_pt[hJCidx]_JES_down[1] 1 1
beff_up: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]Up[0],Jet_btagnew[hJCidx]Up[1]) min(Jet_btagnew[hJCidx]Up[0],Jet_btagnew[hJCidx]Up[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1
beff_down: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]Down[0],Jet_btagnew[hJCidx]Down[1]) min(Jet_btagnew[hJCidx]Down[0],Jet_btagnew[hJCidx]Down[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1
bmis_up: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]FUp[0],Jet_btagnew[hJCidx]FUp[1]) min(Jet_btagnew[hJCidx]FUp[0],Jet_btagnew[hJCidx]FUp[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1
bmis_down: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]FDown[0],Jet_btagnew[hJCidx]FDown[1]) min(Jet_btagnew[hJCidx]FDown[0],Jet_btagnew[hJCidx]FDown[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1
beff1_up: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1
beff1_down: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1

[treeVarsNoMass]
Nominal: H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1


[treeVarsAngularOnly]
Nominal: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 angleHB angleLZ angleZZS HVMass_Reg
JER_up: H_JER.mass_up H_JER.pt_up HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JER_up[0] Jet_pt[hJCidx]_JER_up[1] 1 1 angleHB_JER_up angleLZ angleZZS_JER_up HVMass_JER_up
JER_down: H_JER.mass_down H_JER.pt_down HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JER_down[0] Jet_pt[hJCidx]_JER_down[1] 1 1 angleHB_JER_down angleLZ angleZZS_JER_down HVMass_JER_down
JES_up: H_JES.mass_up H_JES.pt_up HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JES_up[0] Jet_pt[hJCidx]_JES_up[1] 1 1 angleHB_JES_up angleLZ angleZZS_JES_up HVMass_JES_up
JES_down: H_JES.mass_down H_JES.pt_down HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JES_down[0] Jet_pt[hJCidx]_JES_down[1] 1 1 angleHB_JES_down angleLZ angleZZS_JES_down HVMass_JES_down
beff_up: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]Up[0],Jet_btagnew[hJCidx]Up[1]) min(Jet_btagnew[hJCidx]Up[0],Jet_btagnew[hJCidx]Up[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 angleHB angleLZ angleZZS HVMass_Reg
beff_down: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]Down[0],Jet_btagnew[hJCidx]Down[1]) min(Jet_btagnew[hJCidx]Down[0],Jet_btagnew[hJCidx]Down[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 angleHB angleLZ angleZZS HVMass_Reg
bmis_up: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]FUp[0],Jet_btagnew[hJCidx]FUp[1]) min(Jet_btagnew[hJCidx]FUp[0],Jet_btagnew[hJCidx]FUp[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 angleHB angleLZ angleZZS HVMass_Reg
bmis_down: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]FDown[0],Jet_btagnew[hJCidx]FDown[1]) min(Jet_btagnew[hJCidx]FDown[0],Jet_btagnew[hJCidx]FDown[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 angleHB angleLZ angleZZS HVMass_Reg
beff1_up: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 angleHB angleLZ angleZZS HVMass_Reg
beff1_down: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 angleHB angleLZ angleZZS HVMass_Reg

[treeVarsSystMass]
Nominal: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 HVMass_Reg
JER_up: H_JER.mass_up H_JER.pt_up HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JER_up[0] Jet_pt[hJCidx]_JER_up[1] 1 1 HVMass_JER_up
JER_down: H_JER.mass_down H_JER.pt_down HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JER_down[0] Jet_pt[hJCidx]_JER_down[1] 1 1 HVMass_JER_down
JES_up: H_JES.mass_up H_JES.pt_up HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JES_up[0] Jet_pt[hJCidx]_JES_up[1] 1 1 HVMass_JES_up
JES_down: H_JES.mass_down H_JES.pt_down HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx]_JES_down[0] Jet_pt[hJCidx]_JES_down[1] 1 1 HVMass_JES_down
beff_up: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]Up[0],Jet_btagnew[hJCidx]Up[1]) min(Jet_btagnew[hJCidx]Up[0],Jet_btagnew[hJCidx]Up[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 HVMass_Reg
beff_down: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]Down[0],Jet_btagnew[hJCidx]Down[1]) min(Jet_btagnew[hJCidx]Down[0],Jet_btagnew[hJCidx]Down[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 HVMass_Reg
bmis_up: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]FUp[0],Jet_btagnew[hJCidx]FUp[1]) min(Jet_btagnew[hJCidx]FUp[0],Jet_btagnew[hJCidx]FUp[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 HVMass_Reg
bmis_down: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx]FDown[0],Jet_btagnew[hJCidx]FDown[1]) min(Jet_btagnew[hJCidx]FDown[0],Jet_btagnew[hJCidx]FDown[1]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 HVMass_Reg
beff1_up: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 HVMass_Reg
beff1_down: H_mass H_pt HVdPhi V_mass V_pt H.dEta max(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) min(Jet_btagnew[hJCidx[0]],Jet_btagnew[hJCidx[1]]) Sum$(Jet_pt[aJCidx]>20.&abs(Jet_eta[aJCidx])<2.4) H.dR Jet_pt[hJCidx[0]] Jet_pt[hJCidx[1]] 1 1 HVMass_Reg


###########################################################################################
# other things:

[Samples]

DYudsg_nolhe: 'Zudsg','Zudsg5070','Zudsg70100','Zudsg100ext'
DYc_nolhe:    'Zcc',  'Zcc5070',  'Zcc70100',  'Zcc100ext'  
DY1b_nolhe:   'Z1b',  'Z1b5070',  'Z1b70100',  'Z1b100ext'  
DY2b_nolhe:   'Z2b',  'Z2b5070',  'Z2b70100',  'Z2b100ext'  

DYudsg: 'Zudsg','Zudsg1J','Zudsg2J','Zudsg3J','Zudsg4J','ZudsgHT200400','ZudsgHT400','Zudsg5070','Zudsg70100','Zudsg100','Zudsg180','Zudsg100ext'
DYc:    'Zcc',  'Zcc1J',  'Zcc2J',  'Zcc3J',  'Zcc4J',  'ZccHT200400',  'ZccHT400',  'Zcc5070',  'Zcc70100',  'Zcc100',  'Zcc180'  ,'Zcc100ext'  
DY1b:   'Z1b',  'Z1b1J',  'Z1b2J',  'Z1b3J',  'Z1b4J',  'Z1bHT200400',  'Z1bHT400',  'Z1b5070',  'Z1b70100',  'Z1b100',  'Z1b180'  ,'Z1b100ext'  
DY2b:   'Z2b',  'Z2b1J',  'Z2b2J',  'Z2b3J',  'Z2b4J',  'Z2bHT200400',  'Z2bHT400',  'Z2b5070',  'Z2b70100',  'Z2b100',  'Z2b180'  ,'Z2b100ext'  
Diboson:'ZZb','WZb','ZZlight','WZlight','AltZZb','AltWZb','AltZZlight','AltWZlight','WW'
Top:    'TT_FullLept','TT_SemiLept'
s_Top:  'ST_s','ST_t','AltST_tW','STbar_s','STbar_t','AltSTbar_tW'
DrellYan: <!Samples|DYudsg!>,<!Samples|DYc!>,<!Samples|DY1b!>,<!Samples|DY2b!>
DrellYan_nolhe: <!Samples|DYudsg_nolhe!>,<!Samples|DYc_nolhe!>,<!Samples|DY1b_nolhe!>,<!Samples|DY2b_nolhe!>

allSIG: 'ZH110','ZH115','ZH120','ZH125','ZH130','ZH135'
#allBKG: <!Samples|DrellYan!>,<!Samples|Diboson!>,<!Samples|Top!>,<!Samples|s_Top!>
allBKG: 'WJetsHT100','ZJetsH100','ZJetsH200','ZJets'
#allBKG: 'ZJetsH100','ZJetsH200','ZJetsH400','ZJetsH600','WJetsH100','WJetsH200','WJetsH400','WJetsH600','TT','T_s','T_t','T_tW','Tbar_s','Tbar_t','Tbar_tW'
#allBKG: ZJetsH100,ZJetsH200,ZJetsH400,ZJetsH600,WJetsH100,WJetsH200,WJetsH400,WJetsH600,TT,T_s,T_t,T_tW,Tbar_s,Tbar_t,Tbar_tW
allBKG_nolhe: <!Samples|DrellYan_nolhe!>,<!Samples|Diboson!>,<!Samples|Top!>,<!Samples|s_Top!>

allBKG_ZZsplit: <!Samples|DrellYan!>,<!Samples|Diboson_split!>,<!Samples|Top!>,<!Samples|s_Top!>
#allBKG: <!Samples|Diboson!>,<!Samples|Top!>,<!Samples|s_Top!>
BKG_VV_training: <!Samples|DrellYan!>,<!Samples|Top!>,<!Samples|s_Top!>,'WW','WZ'

Group: {'ZH110':'ZH','ZH115':'ZH','ZH120':'ZH','ZH125':'ZH','ZH130':'ZH','ZH135':'ZH','ZH140':'ZH','ZH145':'ZH','ZH150':'ZH','ZH':'ZH',\
        'Zudsg':'DYlight','Zudsg1J':'DYlight','Zudsg2J':'DYlight','Zudsg3J':'DYlight','Zudsg4J':'DYlight','WJetsHT100':'WJets','ZJets':'ZJets','ZJetsHT100':'ZJets','ZJetsHT200':'ZJets',\
        'ZudsgHT200400':'DYlight','ZudsgHT400':'DYlight','Zudsg5070':'DYlight','Zudsg5070ext':'DYlight','Zudsg70100':'DYlight','Zudsg100':'DYlight','Zudsg100ext':'DYlight','Zudsg180':'DYlight',\
        'Zcc':'DYlight','Zcc1J':'DYlight','Zcc2J':'DYlight','Zcc3J':'DYlight','Zcc4J':'DYlight',\
        'ZccHT200400':'DYlight','ZccHT400':'DYlight','Zcc5070':'DYlight','Zcc5070ext':'DYlight','Zcc70100':'DYlight','Zcc100':'DYlight','Zcc100ext':'DYlight','Zcc180':'DYlight',\
        'Z1b':'DY1b','Z1b1J':'DY1b','Z1b2J':'DY1b','Z1b3J':'DY1b','Z1b4J':'DY1b',\
        'Z2b':'DY2b','Z2b1J':'DY2b','Z2b2J':'DY2b','Z2b3J':'DY2b','Z2b4J':'DY2b',\
        'Z1bHT200400':'DY1b','Z1bHT400':'DY1b','Z1b5070':'DY1b','Z1b5070ext':'DY1b','Z1b70100':'DY1b','Z1b100':'DY1b','Z1b100ext':'DY1b','Z1b180':'DY1b',\
        'Z2bHT200400':'DY2b','Z2bHT400':'DY2b','Z2b5070':'DY2b','Z2b5070ext':'DY2b','Z2b70100':'DY2b','Z2b100':'DY2b','Z2b100ext':'DY2b','Z2b180':'DY2b',\
        'ZZb':'VVb','WW':'VVlight','WZb':'VVb','ZZlight':'VVlight','WZlight':'VVlight','ZZlight':'VVlight',\
        'TT':'TT,','TT1':'TT','TT2':'TT','TT_FullLept':'TT','TT_SemiLept':'TT','ST_s':'ST','ST_t':'ST','AltST_tW':'ST','STbar_s':'ST','STbar_t':'ST','AltSTbar_tW':'ST',\
        'Zee':'Data','Zmm':'Data',\
        'AltZZlight':'VVlight','AltZZb':'VVb','AltWZlight':'VVlight','AltWZb':'VVb'}

[Weights]
#5fb:
#weightF: (puWeightAB*weightTrig2012AB*lheWeight)
#weightF_sys_UP: (puWeightP*weightTrig2012AB*lheWeight)
#weightF_sys_DOWN: (puWeightM*weightTrig2012AB*lheWeight)

#nolhe
#weightF: (puWeight*weightTrig2012*lheWeight)
# weightF: (puWeight*weightTrig2012*lheWeight*weightSignalQCD*VHbb::ewkAtlas8TeVZllH(genH_pt,genZ.pt)*VHbb::ptWeightDY(lheV_pt)*VHbb::mueEff(Vtype,vLeptons_eta[0],vLeptons_eta[1],vLeptons_pt[0],vLeptons_pt[1]))
# weightF: (puWeight*VHbb::ewkAtlas8TeVZllH(GenHiggsBoson_pt,GenVbosons_pt)*VHbb::ptWeightDY(lheV_pt)*VHbb::mueEff(Vtype,vLeptons_eta[0],vLeptons_eta[1],vLeptons_pt[0],vLeptons_pt[1]))
weightF: (puWeight)

weightF_sys_UP: (puWeightP*weightTrig2012*lheWeight*weightSignalQCD*VHbb::ewkAtlas8TeVZllH(genH_pt,genZ.pt)*VHbb::ptWeightDY(lheV_pt)*VHbb::mueEff(Vtype,vLeptons_eta[0],vLeptons_eta[1],vLeptons_pt[0],vLeptons_pt[1]))
weightF_sys_DOWN: (puWeightM*weightTrig2012*lheWeight*weightSignalQCD*VHbb::ewkAtlas8TeVZllH(genH_pt,genZ.pt)*VHbb::ptWeightDY(lheV_pt)*VHbb::mueEff(Vtype,vLeptons_eta[0],vLeptons_eta[1],vLeptons_pt[0],vLeptons_pt[1]))
weightF_QCD_UP: (puWeight*weightTrig2012*lheWeight*weightSignalQCD*(1.+(1./weightSignalQCD-1.)*0.5)*VHbb::ewkAtlas8TeVZllH(genH_pt,genZ.pt)*VHbb::ptWeightDY(lheV_pt)*VHbb::mueEff(Vtype,vLeptons_eta[0],vLeptons_eta[1],vLeptons_pt[0],vLeptons_pt[1]))
weightF_QCD_DOWN: (puWeight*weightTrig2012*lheWeight*weightSignalQCD*(1.-(1./weightSignalQCD-1.)*0.5)*VHbb::ewkAtlas8TeVZllH(genH_pt,genZ.pt)*VHbb::ptWeightDY(lheV_pt)*VHbb::mueEff(Vtype,vLeptons_eta[0],vLeptons_eta[1],vLeptons_pt[0],vLeptons_pt[1]))

#weightF: (puWeight*lheWeight)




#!! ---------------------------------------------------------------------------------
#!! ---------------------------------------------------------------------------------
#!! ---------------------------------------------------------------------------------
#!! Datacard
#!! ----------------------------------------------------------------------------------
#!! ----------------------------------------------------------------------------------
#!! ----------------------------------------------------------------------------------
#!! ----------------------------------------------------------------------------------


#!! ----------------------------------------------------
#!! LIMIT
#!! config to configure datacard and workspace writing
#!! ----------------------------------------------------

[Plot_general]
addOverFlow = True

[LimitGeneral]
#!! --------------------------------------
#!! Binning:
#!! --------------------------------------
BDTrange = 20,-1,1
BDToutname = CMS_vhbb_BDT_Zll_8TeV
Mjjrange = 17,0.,255.
#!! control region variables examples
METrange = met_pt,10,0,100
btagrange = csv,20,0,1

#!! Rebinning procedure for the BDT. Only suitable for BDT
#!! For Mjj or for control region put False.
rebin_active = True
#Mjj-> False

#!! --------------------------------------
#!! Systematics
#!! --------------------------------------
sys_BDT = ['JER','JES','beff','bmis']
sys_Mjj = ['JER','JES','beff','bmis','beff1']
#!! systematics for the control region fit
sys_cr = ['beff','bmis','beff1']
#!! configuration of systematics effects and behaviour
sys_factor = {'JER':1.0,'JES':1.0,'beff':1.0,'bmis':1.0,'beff1':1.0}
sys_affecting = {'JER':['ZH','DYlight','DY2b','DY1b','VVlight','TT','ST','ZH125','VVb'],'JES':['ZH','DYlight','DY2b','DY1b','VVlight','TT','ST','ZH125','VVb'],'beff':['ZH','ZH125','DYlight','DY2b','DY1b','VVlight','TT','ST','VVb'],'beff1':['ZH','ZH125'],'bmis':['ZH','DYlight','DY2b','DY1b','VVlight','TT','ST','ZH125','VVb']}
#!! Add a different Cut (syntax: 'oldVar>newVar?' -> '?' will then automatically be replaced with 'Up'/'Down' for the variations)
sys_cut_suffix = {'JER':'nominal','JES':'nominal','beff':'csv>csv?','bmis':'csv>csvF?','beff1':'csv>csv?'}
#sys_cut_suffix: {'JER':'nominal','JES':'nominal','beff':'nominal','bmis':'nominal','beff1':'nominal'}
sys_cut_include = ['ZH','VVb','ST','VVlight']
#!! UEPS
#weightF_sys = True
weightF_sys = ['weightF_sys','weightF_QCD']
#!! Example of sample systematic, in this case the ZZ sample is replaced by WZ
#addSample_sys = {'ZZ-light':'AltZZ-light','ZZ-bb':'AltZZ-bb','WZ':'AltWZ'}


#!! --------------------------------------
#!! Options
#!! --------------------------------------
#!! bin-by-bin statistics, not available!
binstat: False
#!! rescale stat shapes by sqrtN
rescaleSqrtN: True
#!! no stat shapes at all:
ignore_stats: False
#!! inject signal, e.g. ZH125 (working?)
signal_inject: None
#!! add signal als BKG, e.g. ZH125 (working?)
add_signal_as_bkg: None
#!! blind Data
blind: True
#blind: False
#!! toy Data
toy: False

#!! --------------------------------------
#!! Samples
#!! --------------------------------------
#!! Datacard samples setup (1st Signal, afterwards BKG)
#setup: ['ZH', 'ZJetsHT100',  'ZJetsHT200',  'ZJets','WJets','TT','ST']
setup: ['ZH', 'ZJets']
#setup: ['ZH', 'ZJets','WJets','TT','ST']
#setup: ['ZH', 'DYlight','DYb','VV','TT','ST']
#!! Lists from general config
#BKG = [<!Samples|allBKG!>]
BKG = ['ZJets','WJets','ZJetsHT100','WJetsHT100']
Group = <!Samples|Group!>

#!! --------------------------------------
#!! Naming
#!! --------------------------------------
#!! naming of processes
Dict = {'ZH':'ZH','DYlight':'Zj0b','DY1b':'Zj1b','DY2b':'Zj2b','TT':'TT','ST':'s_Top','VVb':'VVHF','VVlight':'VVLF','Data':'data_obs','ZH125':'H125','WJets':'W+jets','ZJetsHT100':'ZJetsHT100','ZJetsHT200':'ZJetsHT200','ZJets':'ZJets'}
#!! naming of systematics
systematicsnaming = {'JER':'CMS_vhbb_res_j','JES':'CMS_vhbb_scale_j','beff':'CMS_vhbb_eff_b','bmis':'CMS_vhbb_fake_b_8TeV','beff1':'CMS_vhbb_eff_b_SIG','stats': 'CMS_vhbb_stats','weightF_sys':'UEPS','weightF_QCD':'sysQCD','model':'CMS_vhbb_model'}


#!! --------------------------------------
#!! to be processed in batch mode
#!! --------------------------------------

#List = RMed_120_ZH125_MM_8TeV_oct,RMed_120_ZH125_EE_8TeV_oct,RTight_120_ZH125_MM_8TeV_oct,RTight_120_ZH125_EE_8TeV_oct,RLoose_ZH125_MM_8TeV_oct,RLoose_ZH125_EE_8TeV_oct
List = RTight_ZH125_EE_8TeV_oct,RMed_ZH125_EE_8TeV_oct,RTight_ZH125_MM_8TeV_oct,RMed_ZH125_MM_8TeV_oct,RTight_ZH130_EE_8TeV_oct,RMed_ZH130_EE_8TeV_oct,RTight_ZH130_MM_8TeV_oct,RMed_ZH130_MM_8TeV_oct,RTight_ZH135_EE_8TeV_oct,RMed_ZH135_EE_8TeV_oct,RTight_ZH135_MM_8TeV_oct,RMed_ZH135_MM_8TeV_oct,RTight_ZH140_EE_8TeV_oct,RMed_ZH140_EE_8TeV_oct,RTight_ZH140_MM_8TeV_oct,RMed_ZH140_MM_8TeV_oct,RTight_ZH145_EE_8TeV_oct,RMed_ZH145_EE_8TeV_oct,RTight_ZH145_MM_8TeV_oct,RMed_ZH145_MM_8TeV_oct,RTight_ZH150_EE_8TeV_oct,RMed_ZH150_EE_8TeV_oct,RTight_ZH150_MM_8TeV_oct,RMed_ZH150_MM_8TeV_oct,RTight_ZH120_EE_8TeV_oct,RMed_ZH120_EE_8TeV_oct,RTight_ZH120_MM_8TeV_oct,RMed_ZH120_MM_8TeV_oct,RTight_ZH115_EE_8TeV_oct,RMed_ZH115_EE_8TeV_oct,RTight_ZH115_MM_8TeV_oct,RMed_ZH115_MM_8TeV_oct,RTight_ZH110_EE_8TeV_oct,RMed_ZH110_EE_8TeV_oct,RTight_ZH110_MM_8TeV_oct,RMed_ZH110_MM_8TeV_oct

#!! --------------------------------------
#!! Datacards specif setup
#!! --------------------------------------
[Datacard]

InUse = ['lumi_8TeV','pdf_qqbar','pdf_gg','QCDscale_VH','QCDscale_ttbar','QCDscale_VV','QCDscale_QCD','CMS_vhbb_boost_EWK','CMS_vhbb_boost_QCD','CMS_vhbb_ST','CMS_vhbb_VV','CMS_eff_e','CMS_eff_m','CMS_vhbb_Zj2b_Zll_SF_8TeV','CMS_vhbb_Zj1b_Zll_SF_8TeV','CMS_vhbb_Zj0b_Zll_SF_8TeV','CMS_vhbb_TT_Zll_SF_8TeV']

InUse_HighPt = <!Datacard|InUse!> + ['CMS_vhbb_ZjLF_Zll_exHighPt_8TeV','CMS_vhbb_ZjHF_Zll_exHighPt_8TeV','CMS_vhbb_TT_Zll_exHighPt_8TeV']
InUse_LowPt = <!Datacard|InUse!> + ['CMS_vhbb_ZjLF_Zll_exLowPt_8TeV','CMS_vhbb_ZjHF_Zll_exLowPt_8TeV','CMS_vhbb_TT_Zll_exLowPt_8TeV']
InUse_HighPtLooseBTag = <!Datacard|InUse!> + ['CMS_vhbb_ZjLF_Zll_exHighPtLooseBTag_8TeV','CMS_vhbb_ZjHF_Zll_exHighPtLooseBTag_8TeV','CMS_vhbb_TT_Zll_exHighPtLoooseBTag_8TeV']

lumi_7TeV = {'type':'lnN', 'ZH':1.022,'ST':1.022,'VV':1.022,'VVlight':1.022,'VVb':1.022}
#lumi_8TeV = {'type':'lnN', 'ZH':1.05,'ST':1.05,'VV':1.05,'VVlight':1.05,'VVb':1.05}
lumi_8TeV = {'type':'lnN', 'ZH':1.05,'ST':1.05,'VV':1.05,'VVlight':1.05,'VVb':1.05,'WJets':1.05,'ZJetsHT100':1.05,'ZJets':1.05}

pdf_qqbar = {'type':'lnN', 'ZH':1.01,'VVlight':1.01,'VVb':1.01}
pdf_gg = {'type':'lnN', 'ST':1.01,'QCD':1.01}
QCDscale_VH = {'type':'lnN', 'ZH':1.04}
QCDscale_ttbar = {'type':'lnN', 'ST':1.06}
QCDscale_VV = {'type':'lnN', 'VVlight':1.04, 'VVb':1.04} 
QCDscale_QCD = {'type':'lnN', 'QCD':1.30}
CMS_vhbb_boost_EWK = {'type':'lnN', 'ZH':1.02,'ZH125':1.02}
CMS_vhbb_boost_QCD = {'type':'lnN', 'ZH':1.10,'ZH125':1.10}
CMS_vhbb_ST = {'type':'lnN', 'ST':1.29}

CMS_vhbb_VV = {'type':'lnN', 'VVlight':1.15, 'VVb':1.15}
CMS_vhbb_ZjLF_ex = {'type':'lnN', 'DYlight':1.05}
CMS_vhbb_ZjHF_ex = {'type':'lnN', 'DYb':1.05}
CMS_vhbb_TT_ex = {'type':'lnN', 'TT':1.05}
CMS_eff_e = {'type':'lnN', 'ZH':1.04,'ZH125':1.04,'ST':1.04,'VVlight':1.04,'QCD':1.04,'VVb':1.04}
CMS_trigger_e = {'type':'lnN','ZH':1.02,'ZH125':1.02,'ST':1.02,'VVlight':1.02 ,'VVb':1.02}
CMS_eff_m = {'type':'lnN',  'ZH':1.04,'ZH125':1.04,'ST':1.04,'VVlight':1.04,'QCD':1.04,'VVb':1.04}
CMS_trigger_m = {'type':'lnN', 'ZH':1.01,'ZH125':1.01,'ST':1.01,'VVlight':1.01,'VVb':1.01 }

CMS_vhbb_ZjLF_Zll_exHighPtLooseBTag_8TeV = {'type':'lnN', 'DYlight':1.20}
CMS_vhbb_ZjHF_Zll_exHighPtLooseBTag_8TeV = {'type':'lnN', 'DYb':1.20}
CMS_vhbb_TT_Zll_exHighPtLoooseBTag_8TeV = {'type':'lnN', 'TT':1.20}
CMS_vhbb_ZjLF_Zll_exHighPt_8TeV = {'type':'lnN', 'DYlight':1.02}
CMS_vhbb_ZjHF_Zll_exHighPt_8TeV = {'type':'lnN', 'DY1b':1.02, 'DY2b':1.02}
CMS_vhbb_TT_Zll_exHighPt_8TeV = {'type':'lnN', 'TT':1.02}
CMS_vhbb_ZjLF_Zll_exLowPt_8TeV = {'type':'lnN', 'DYlight':1.02}
CMS_vhbb_ZjHF_Zll_exLowPt_8TeV = {'type':'lnN', 'DY1b':1.02, 'DY2b':1.02}
CMS_vhbb_TT_Zll_exLowPt_8TeV = {'type':'lnN', 'TT':1.02}

#!! splitting 1b / 2b
CMS_vhbb_Zj0b_Zll_SF_8TeV: {'type':'lnN', 'DYlight':1.01}
CMS_vhbb_Zj1b_Zll_SF_8TeV: {'type':'lnN', 'DY1b':1.07}
CMS_vhbb_Zj2b_Zll_SF_8TeV: {'type':'lnN', 'DY2b':1.07}
CMS_vhbb_TT_Zll_SF_8TeV: {'type':'lnN', 'TT':1.02} 


#!! -------------------------
#!! Limit definitions
#!! -------------------------
[dc:myTest] 
var = testBDT.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M125_ZvvHighPt_13TeV
cut = MyRTight
signal = ZH
dcBin = ZvvHighPt_13TeV
data = WJetsHT100
type= BDT

[dc:RMed_ZH125_EE_8TeV_oct] 
var = RMed_ZH125_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M125_ZeeLowPt_8TeV
cut = RMed_EE
signal = ZH125
dcBin = ZeeLowPt_8TeV
data = Zee
type= BDT

[dc:RMed_ZH125_MM_8TeV_oct] 
var = RMed_ZH125_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M125_ZmmLowPt_8TeV
cut = RMed_MM
signal = ZH125
dcBin = ZmmLowPt_8TeV
data = Zmm
type= BDT

[dc:RTight_ZH125_EE_8TeV_oct] 
var = RTight_ZH125_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M125_ZeeHighPt_8TeV
cut = RTight_EE
signal = ZH125
dcBin = ZeeHighPt_8TeV
data = Zee
type= BDT

[dc:RTight_ZH125_MM_8TeV_oct] 
var = RTight_ZH125_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M125_ZmmHighPt_8TeV
cut = RTight_MM
signal = ZH125
dcBin = ZmmHighPt_8TeV
data = Zmm
type= BDT

[dc:RMed_ZH130_EE_8TeV_oct] 
var = RMed_ZH130_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M130_ZeeLowPt_8TeV
cut = RMed_EE
signal = ZH130
dcBin = ZeeLowPt_8TeV
data = Zee
type= BDT

[dc:RMed_ZH130_MM_8TeV_oct] 
var = RMed_ZH130_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M130_ZmmLowPt_8TeV
cut = RMed_MM
signal = ZH130
dcBin = ZmmLowPt_8TeV
data = Zmm
type= BDT

[dc:RTight_ZH130_EE_8TeV_oct] 
var = RTight_ZH130_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M130_ZeeHighPt_8TeV
cut = RTight_EE
signal = ZH130
dcBin = ZeeHighPt_8TeV
data = Zee
type= BDT

[dc:RTight_ZH130_MM_8TeV_oct] 
var = RTight_ZH130_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M130_ZmmHighPt_8TeV
cut = RTight_MM
signal = ZH130
dcBin = ZmmHighPt_8TeV
data = Zmm
type= BDT

[dc:RMed_ZH135_EE_8TeV_oct] 
var = RMed_ZH135_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M135_ZeeLowPt_8TeV
cut = RMed_EE
signal = ZH135
dcBin = ZeeLowPt_8TeV
data = Zee
type= BDT

[dc:RMed_ZH135_MM_8TeV_oct] 
var = RMed_ZH135_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M135_ZmmLowPt_8TeV
cut = RMed_MM
signal = ZH135
dcBin = ZmmLowPt_8TeV
data = Zmm
type= BDT

[dc:RTight_ZH135_EE_8TeV_oct] 
var = RTight_ZH135_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M135_ZeeHighPt_8TeV
cut = RTight_EE
signal = ZH135
dcBin = ZeeHighPt_8TeV
data = Zee
type= BDT

[dc:RTight_ZH135_MM_8TeV_oct] 
var = RTight_ZH135_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M135_ZmmHighPt_8TeV
cut = RTight_MM
signal = ZH135
dcBin = ZmmHighPt_8TeV
data = Zmm
type= BDT

[dc:RMed_ZH140_EE_8TeV_oct] 
var = RMed_ZH140_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M140_ZeeLowPt_8TeV
cut = RMed_EE
signal = ZH140
dcBin = ZeeLowPt_8TeV
data = Zee
type= BDT

[dc:RMed_ZH140_MM_8TeV_oct] 
var = RMed_ZH140_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M140_ZmmLowPt_8TeV
cut = RMed_MM
signal = ZH140
dcBin = ZmmLowPt_8TeV
data = Zmm
type= BDT

[dc:RTight_ZH140_EE_8TeV_oct] 
var = RTight_ZH140_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M140_ZeeHighPt_8TeV
cut = RTight_EE
signal = ZH140
dcBin = ZeeHighPt_8TeV
data = Zee
type= BDT

[dc:RTight_ZH140_MM_8TeV_oct] 
var = RTight_ZH140_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M140_ZmmHighPt_8TeV
cut = RTight_MM
signal = ZH140
dcBin = ZmmHighPt_8TeV
data = Zmm
type= BDT

[dc:RMed_ZH145_EE_8TeV_oct] 
var = RMed_ZH145_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M145_ZeeLowPt_8TeV
cut = RMed_EE
signal = ZH145
dcBin = ZeeLowPt_8TeV
data = Zee
type= BDT

[dc:RMed_ZH145_MM_8TeV_oct] 
var = RMed_ZH145_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M145_ZmmLowPt_8TeV
cut = RMed_MM
signal = ZH145
dcBin = ZmmLowPt_8TeV
data = Zmm
type= BDT

[dc:RTight_ZH145_EE_8TeV_oct] 
var = RTight_ZH145_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M145_ZeeHighPt_8TeV
cut = RTight_EE
signal = ZH145
dcBin = ZeeHighPt_8TeV
data = Zee
type= BDT

[dc:RTight_ZH145_MM_8TeV_oct] 
var = RTight_ZH145_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M145_ZmmHighPt_8TeV
cut = RTight_MM
signal = ZH145
dcBin = ZmmHighPt_8TeV
data = Zmm
type= BDT


[dc:RMed_ZH150_EE_8TeV_oct] 
var = RMed_ZH150_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M150_ZeeLowPt_8TeV
cut = RMed_EE
signal = ZH150
dcBin = ZeeLowPt_8TeV
data = Zee
type= BDT

[dc:RMed_ZH150_MM_8TeV_oct] 
var = RMed_ZH150_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M150_ZmmLowPt_8TeV
cut = RMed_MM
signal = ZH150
dcBin = ZmmLowPt_8TeV
data = Zmm
type= BDT

[dc:RTight_ZH150_EE_8TeV_oct] 
var = RTight_ZH150_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M150_ZeeHighPt_8TeV
cut = RTight_EE
signal = ZH150
dcBin = ZeeHighPt_8TeV
data = Zee
type= BDT

[dc:RTight_ZH150_MM_8TeV_oct] 
var = RTight_ZH150_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M150_ZmmHighPt_8TeV
cut = RTight_MM
signal = ZH150
dcBin = ZmmHighPt_8TeV
data = Zmm
type= BDT


[dc:RMed_ZH120_EE_8TeV_oct] 
var = RMed_ZH120_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M120_ZeeLowPt_8TeV
cut = RMed_EE
signal = ZH120
dcBin = ZeeLowPt_8TeV
data = Zee
type= BDT

[dc:RMed_ZH120_MM_8TeV_oct] 
var = RMed_ZH120_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M120_ZmmLowPt_8TeV
cut = RMed_MM
signal = ZH120
dcBin = ZmmLowPt_8TeV
data = Zmm
type= BDT

[dc:RTight_ZH120_EE_8TeV_oct] 
var = RTight_ZH120_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M120_ZeeHighPt_8TeV
cut = RTight_EE
signal = ZH120
dcBin = ZeeHighPt_8TeV
data = Zee
type= BDT

[dc:RTight_ZH120_MM_8TeV_oct] 
var = RTight_ZH120_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M120_ZmmHighPt_8TeV
cut = RTight_MM
signal = ZH120
dcBin = ZmmHighPt_8TeV
data = Zmm
type= BDT

[dc:RMed_ZH115_EE_8TeV_oct] 
var = RMed_ZH115_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M115_ZeeLowPt_8TeV
cut = RMed_EE
signal = ZH115
dcBin = ZeeLowPt_8TeV
data = Zee
type= BDT

[dc:RMed_ZH115_MM_8TeV_oct] 
var = RMed_ZH115_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M115_ZmmLowPt_8TeV
cut = RMed_MM
signal = ZH115
dcBin = ZmmLowPt_8TeV
data = Zmm
type= BDT

[dc:RTight_ZH115_EE_8TeV_oct] 
var = RTight_ZH115_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M115_ZeeHighPt_8TeV
cut = RTight_EE
signal = ZH115
dcBin = ZeeHighPt_8TeV
data = Zee
type= BDT

[dc:RTight_ZH115_MM_8TeV_oct] 
var = RTight_ZH115_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M115_ZmmHighPt_8TeV
cut = RTight_MM
signal = ZH115
dcBin = ZmmHighPt_8TeV
data = Zmm
type= BDT

[dc:RMed_ZH110_EE_8TeV_oct] 
var = RMed_ZH110_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M110_ZeeLowPt_8TeV
cut = RMed_EE
signal = ZH110
dcBin = ZeeLowPt_8TeV
data = Zee
type= BDT

[dc:RMed_ZH110_MM_8TeV_oct] 
var = RMed_ZH110_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M110_ZmmLowPt_8TeV
cut = RMed_MM
signal = ZH110
dcBin = ZmmLowPt_8TeV
data = Zmm
type= BDT

[dc:RTight_ZH110_EE_8TeV_oct] 
var = RTight_ZH110_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M110_ZeeHighPt_8TeV
cut = RTight_EE
signal = ZH110
dcBin = ZeeHighPt_8TeV
data = Zee
type= BDT

[dc:RTight_ZH110_MM_8TeV_oct] 
var = RTight_ZH110_oct.nominal
wsVarName = <!LimitGeneral|BDToutname!>
range = <!LimitGeneral|BDTrange!>
dcName = BDT_M110_ZmmHighPt_8TeV
cut = RTight_MM
signal = ZH110
dcBin = ZmmHighPt_8TeV
data = Zmm
type= BDT




